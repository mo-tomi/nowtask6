# モックアップUI実装 要件定義書

**作成日**: 2025年10月17日
**バージョン**: 1.0.0
**対象**: nowtask Androidアプリ UI刷新

---

## 📋 目次

1. [プロジェクト概要](#プロジェクト概要)
2. [目的と背景](#目的と背景)
3. [機能要件](#機能要件)
4. [非機能要件](#非機能要件)
5. [既存機能の保持](#既存機能の保持)
6. [UI/UXデザイン要件](#uiuxデザイン要件)
7. [技術要件](#技術要件)
8. [制約条件](#制約条件)
9. [リスクと対策](#リスクと対策)

---

## プロジェクト概要

### プロジェクト名
nowtask Androidアプリ UI刷新プロジェクト

### 目標
`ui-mockups-mobile.html`で設計されたモノクロUIデザインをAndroidアプリに適用し、既存の全機能を維持しながらユーザー体験を向上させる。

### スコープ
- **対象**: android-app/app/src/main/assets/ 配下のHTML/CSS/JS
- **範囲**: UI/UXの刷新（機能追加・削除は行わない）
- **期間**: 段階的実装（フェーズ1〜6）

---

## 目的と背景

### 背景
現在のnowtaskアプリは機能的には完成しているが、UIが統一されておらず、ユーザビリティに改善の余地がある。モックアップで洗練されたデザインが完成したため、これを実装に移す。

### 目的
1. **視認性の向上**: モノクロデザインで情報の優先度を明確化
2. **操作性の向上**: タッチターゲットの最適化、ジェスチャー対応
3. **一貫性の確保**: 全画面で統一されたデザイン言語
4. **パフォーマンス維持**: 既存の高速レンダリングを維持
5. **機能の完全保持**: 既存機能を100%維持

---

## 機能要件

### FR-001: ヘッダー
#### 要件
- アプリタイトル「nowtask」を左上に配置
- 右側にアクションボタンを配置：
  - カレンダーアイコン（SVG）
  - アカウントアイコン（SVG）
  - 設定アイコン（SVG）
  - メニューアイコン（SVG）

#### 仕様
- 高さ: 57px
- 背景: #ffffff
- 枠線: 1px solid #e0e0e0
- position: sticky（スクロール時に固定）
- z-index: 5

#### 既存機能との連携
- カレンダーボタン → カレンダーモーダル表示
- アカウントボタン → ログインモーダル表示
- 設定ボタン → 設定モーダル表示
- メニューボタン → メニューモーダル表示

---

### FR-002: 24時間ゲージ
#### 要件
- 24ステップ方式（1時間=1ブロック）
- ナビゲーションヘッダー（前日/次日ボタン）
- 現在時刻の表示
- 残り時間の表示

#### 仕様詳細
[GAUGE_SPECIFICATION.md](./GAUGE_SPECIFICATION.md)を参照

#### 既存機能との連携
- `gauge.js` の全機能を維持
- 日付切り替え機能
- タスク時間の可視化
- 空き時間計算

---

### FR-003: タスクカード
#### 要件
- 右側チェックボックス配置
- メニューボタン（⋮）の追加
- 優先度による色分け
- サブタスク表示対応

#### 仕様
```
構造:
[タスク本体] [メニュー] [チェックボックス]

サイズ:
- パディング: 12px
- チェックボックス: 24x24px
- メニューボタン: 24x24px

色分け:
- 優先度高: 左枠線 #ff6b6b
- 優先度中: 左枠線 #ffa500
- 優先度低: 左枠線 #4dabf7
- 緊急: 左枠線 #d63031
```

#### 既存機能との連携
- `render.js` のタスク描画機能
- ドラッグ&ドロップ
- スワイプジェスチャー
- サブタスク展開/折りたたみ

---

### FR-004: セクションラベル
#### 要件
- 「本日のタスク」などのセクション区切り
- 右側に「+」追加ボタン配置
- スティッキー配置（スクロール時に固定）

#### 仕様
- 背景: #333
- 文字色: white
- 高さ: 37px
- position: sticky
- top: 57px（ヘッダーの下）
- z-index: 4

---

### FR-005: 複数選択モード
#### 要件
- 複数選択トグルボタン
- 選択中のタスクを視覚的にハイライト
- 一括操作ツールバー表示

#### 仕様
```
ボタン配置: セクションラベルの下
デザイン: ☑ 複数選択

選択時の表示:
- タスクカードに2px枠線（#000）
- チェックボックスにチェックマーク

ツールバー:
- 完了ボタン
- 削除ボタン
- 日付変更ボタン
- 優先度変更ボタン
```

#### 既存機能との連携
- `render.js` の一括選択機能
- `events.js` の一括操作イベント

---

### FR-006: 完了済みセクション
#### 要件
- 折りたたみ可能
- 完了タスク件数表示
- アニメーション対応

#### 仕様
```
表示:
▶ 完了済み (2)

展開時:
▼ 完了済み (2)
  [完了タスク1]
  [完了タスク2]

スタイル:
- 背景: #f8f8f8
- 枠線: 1px solid #e0e0e0
- border-radius: 8px
```

---

### FR-007: 空の状態表示
#### 要件
- タスクが0件の時の表示
- SVGイラスト + メッセージ

#### 仕様
```html
<div class="empty-state">
  <svg>時計アイコン</svg>
  <p>タスクがありません</p>
  <small>+ ボタンからタスクを追加しましょう</small>
</div>
```

---

### FR-008: クイック入力バー
#### 要件
- 画面下部固定
- 履歴ボタン
- テキスト入力
- 日付設定ボタン
- 送信ボタン

#### 仕様
```
配置: position: fixed; bottom: 0;
背景: #000
高さ: 60px
z-index: 100

ボタン配置:
[履歴] [テキスト入力 [日付] [送信]]
```

#### 既存機能との連携
- `input-experience.js` の全機能
- 履歴表示
- 日付ピッカー
- Enter送信

---

### FR-009: FABボタン
#### 要件
- 新規タスク作成ボタン
- 右下固定配置
- タップでモーダル表示

#### 仕様
```
サイズ: 56x56px
位置: bottom: 20px; right: 20px;
背景: #000
色: white
アイコン: +
影: 0 4px 12px rgba(0,0,0,0.3)
```

---

## 非機能要件

### NFR-001: パフォーマンス
- タスクリストのレンダリング: 500ms以内
- スクロール: 60fps維持
- モーダル表示: 200ms以内

### NFR-002: 互換性
- Android 8.0 (API 26) 以上
- WebView: Chrome 90以上相当
- 画面サイズ: 320px〜800px幅に対応

### NFR-003: アクセシビリティ
- タッチターゲット: 最小44x44px
- コントラスト比: WCAG AA準拠
- キーボード操作対応

### NFR-004: データ整合性
- 既存のlocalStorageデータを保持
- Firestoreとの同期を維持
- データ移行不要

---

## 既存機能の保持

### 必須保持機能リスト

#### コア機能（core.js, tasks.js）
- ✓ タスクCRUD操作
- ✓ サブタスク管理
- ✓ ルーティン機能
- ✓ タイマー機能
- ✓ データ永続化（localStorage + Firestore）

#### UI機能（render.js, ui-main.js）
- ✓ タスクリスト描画
- ✓ ドラッグ&ドロップ
- ✓ スワイプジェスチャー
- ✓ 日付グループ化
- ✓ 複数選択モード

#### モーダル（modals.js）
- ✓ タスク作成/編集モーダル
- ✓ 設定モーダル
- ✓ ルーティン設定
- ✓ テンプレート選択
- ✓ カレンダー表示

#### 検索・フィルター（search-filter.js）
- ✓ リアルタイム検索
- ✓ 複数フィルター
- ✓ ソート機能
- ✓ 検索履歴

#### 認証（auth.js）
- ✓ Google Sign-In
- ✓ Firebase Auth
- ✓ Android経由の認証

#### その他
- ✓ 24時間ゲージ（gauge.js）
- ✓ 分析機能（analytics.js）
- ✓ 共有機能（share.js）
- ✓ カレンダー（calendar.js）
- ✓ カスタマイズ（customization.js）
- ✓ アニメーション（animations.js）
- ✓ アクセシビリティ（accessibility.js）
- ✓ パフォーマンス最適化（performance.js）
- ✓ フィードバック（feedback.js）
- ✓ ヘルプ（help.js）

---

## UI/UXデザイン要件

### デザイン原則
1. **モノクロ**: 黒・白・グレーのみ使用（強調色は例外）
2. **ミニマル**: 不要な装飾を排除
3. **明確な階層**: 情報の優先度を視覚的に表現
4. **高い操作性**: タッチに最適化されたUI

### カラーパレット
```css
/* 基本色 */
--primary-black: #000000;
--primary-white: #ffffff;
--gray-dark: #333333;
--gray-medium: #666666;
--gray-light: #999999;
--gray-lightest: #e0e0e0;
--background: #f5f5f5;

/* 機能色 */
--priority-high: #ff6b6b;
--priority-medium: #ffa500;
--priority-low: #4dabf7;
--urgent: #d63031;
--error: #f44336;

/* 境界線 */
--border-color: #e0e0e0;
--border-dark: #d0d0d0;
```

### タイポグラフィ
```css
/* フォント */
font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;

/* サイズ */
--text-xxl: 18px;  /* タイトル */
--text-xl: 16px;   /* 見出し */
--text-lg: 14px;   /* 本文 */
--text-md: 12px;   /* 補助 */
--text-sm: 11px;   /* ラベル */
--text-xs: 10px;   /* メタ情報 */
```

### スペーシング
```css
--space-xs: 4px;
--space-sm: 8px;
--space-md: 12px;
--space-lg: 16px;
--space-xl: 20px;
--space-xxl: 24px;
```

### 角丸
```css
--radius-sm: 4px;   /* ボタン、バッジ */
--radius-md: 8px;   /* カード */
--radius-lg: 12px;  /* モーダル */
```

---

## 技術要件

### フロントエンド
- HTML5 + CSS3
- Vanilla JavaScript (ES6+)
- WebView内で実行

### データ層
- localStorage（ローカル保存）
- Firebase Firestore（クラウド同期）
- Android Bridge（ネイティブ連携）

### 依存ライブラリ
- html2canvas: 画像生成
- Firebase SDK: 認証・データベース

### ファイル構成
```
android-app/app/src/main/assets/
├── index.html          # メインHTML
├── style.css           # 既存スタイル（一部保持）
├── animations.css      # アニメーション
├── css/
│   ├── style-base.css       # 基本スタイル（NEW）
│   └── style-components.css # コンポーネント（NEW）
└── js/
    └── (既存23ファイル全て保持)
```

---

## 制約条件

### 技術的制約
1. **Android WebView**: Chrome相当の機能のみ使用可能
2. **ファイルサイズ**: APKサイズを大幅に増やさない
3. **既存データ**: 破壊的変更禁止

### 運用的制約
1. **リリーススケジュール**: 段階的リリース（フェーズごと）
2. **テスト**: 各フェーズ完了時にQA実施
3. **ロールバック**: 問題発生時は即座に戻せる設計

---

## リスクと対策

### リスク1: 既存機能の破壊
**発生確率**: 中
**影響度**: 高
**対策**:
- 各フェーズ完了後に全機能テスト
- Git tagでバージョン管理
- 問題発生時は即座にロールバック

### リスク2: パフォーマンス低下
**発生確率**: 低
**影響度**: 中
**対策**:
- レンダリング処理の最適化維持
- 仮想スクロール継続使用
- CSSアニメーションの最適化

### リスク3: デザイン仕様の齟齬
**発生確率**: 中
**影響度**: 低
**対策**:
- モックアップとの差分を都度確認
- 実装前にデザインレビュー
- フィードバックループの確立

### リスク4: 開発期間の延長
**発生確率**: 中
**影響度**: 中
**対策**:
- 各フェーズで独立して動作する設計
- 優先度付けによる段階的実装
- 早期のプロトタイプ作成

---

## 承認

この要件定義書は、以下の実装計画（task2.md）の基礎となります。

**次のステップ**: task2.mdで具体的なフェーズ別実装計画を作成

---

**改訂履歴**

| 日付 | バージョン | 変更内容 | 作成者 |
|------|-----------|---------|--------|
| 2025-10-17 | 1.0.0 | 初版作成 | Claude |
